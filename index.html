<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå‘˜å·¥æŒ‡æŒ¥ä¸­å¿ƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Import Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            min-height: 100vh;
            background-color: #f3f4f6;
            font-family: sans-serif;
        }
        .container {
            display: flex;
            flex-grow: 1;
        }
        .sidebar {
            width: 300px;
            background-color: #e2e8f0;
            padding: 1rem;
            border-right: 1px solid #cbd5e1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        .main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            padding: 2rem;
            overflow-y: auto;
        }
        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal {
            display: flex;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fff;
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar for Document History -->
        <div class="sidebar">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-blue-800">é¡¹ç›®æ–‡æ¡£åº“</h2>
                <button id="logout-button" class="px-4 py-2 bg-red-500 text-white rounded-full font-semibold text-sm hover:bg-red-600 transition-colors duration-300">ç™»å‡º</button>
            </div>
            <ul id="doc-list" class="space-y-2 flex-grow">
                <!-- Documents will be dynamically added here -->
            </ul>
        </div>

        <!-- Main Dashboard -->
        <div class="main-content">
            <div class="max-w-4xl mx-auto w-full">
                <h1 class="text-3xl font-bold text-center text-blue-800 mb-4">AIæ•°å­—å…¬å¸æŒ‡æŒ¥ä¸­å¿ƒ</h1>
                <p id="user-info" class="text-center text-gray-600 mb-2"></p>
                <p class="text-center text-gray-600 mb-8">é€‰æ‹©ä½ çš„AIå‘˜å·¥ï¼Œå¹¶åˆ†é…ä»»åŠ¡ã€‚</p>
                
                <!-- Main App Content (Hidden until authenticated) -->
                <div id="main-app" class="hidden">
                    <!-- Employee Selection -->
                    <div id="employee-selection" class="flex flex-wrap justify-center gap-4 mb-6">
                        <button data-employee="AIæ¶æ„å¸ˆ" class="px-6 py-3 rounded-full font-semibold transition-all duration-300 bg-gray-200 text-blue-800 hover:bg-blue-100">AIæ¶æ„å¸ˆ ğŸ‘©â€ğŸ’»</button>
                        <button data-employee="AIç¨‹åºå‘˜" class="px-6 py-3 rounded-full font-semibold transition-all duration-300 bg-gray-200 text-blue-800 hover:bg-blue-100">AIç¨‹åºå‘˜ ğŸ‘¨â€ğŸ’»</button>
                        <button data-employee="AIæ–‡æ¡£å‘˜" class="px-6 py-3 rounded-full font-semibold transition-all duration-300 bg-gray-200 text-blue-800 hover:bg-blue-100">AIæ–‡æ¡£å‘˜ âœï¸</button>
                        <button data-employee="AIæµ‹è¯•å‘˜" class="px-6 py-3 rounded-full font-semibold transition-all duration-300 bg-gray-200 text-blue-800 hover:bg-blue-100">AIæµ‹è¯•å‘˜ ğŸ§ª</button>
                        <button data-employee="AIå¸‚åœºä¸“å‘˜" class="px-6 py-3 rounded-full font-semibold transition-all duration-300 bg-gray-200 text-blue-800 hover:bg-blue-100">AIå¸‚åœºä¸“å‘˜ ğŸ“ˆ</button>
                    </div>

                    <!-- Prompt Input -->
                    <div class="mb-6">
                        <label id="prompt-label" class="block text-gray-700 font-semibold mb-2">ä½ çš„æŒ‡ä»¤ (è¯·å…ˆé€‰æ‹©å‘˜å·¥):</label>
                        <textarea id="prompt-input" class="w-full h-32 px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:border-blue-500 transition-all duration-300 resize-none" placeholder="ä¾‹å¦‚ï¼šè¯·ä¸ºMVPçš„ç™»å½•åŠŸèƒ½è®¾è®¡æ•°æ®åº“è¡¨ç»“æ„ã€‚"></textarea>
                    </div>
                    
                    <!-- Action Button -->
                    <div class="flex justify-center mb-8">
                        <button id="generate-button" class="px-8 py-4 bg-green-500 text-white font-bold rounded-full shadow-md hover:bg-green-600 transition-all duration-300 transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed">æäº¤ä»»åŠ¡</button>
                    </div>

                    <!-- File Upload Section -->
                    <div class="mb-6 border-t pt-6">
                        <h3 class="text-lg font-bold mb-2 text-blue-800">æ–‡æ¡£ä¸Šä¼ </h3>
                        <div class="flex items-center gap-4">
                            <input type="file" id="file-upload" class="flex-grow p-2 rounded-lg border-2 border-gray-300">
                            <button id="upload-button" class="px-4 py-2 bg-blue-500 text-white rounded-full font-semibold hover:bg-blue-600 transition-colors duration-300">ä¸Šä¼ </button>
                        </div>
                    </div>

                    <!-- Output Display -->
                    <div class="bg-gray-50 rounded-lg p-6 border border-gray-200 min-h-80">
                        <h2 class="text-xl font-bold text-gray-700 mb-4">AIå‘˜å·¥çš„è¾“å‡º:</h2>
                        <div id="output-display" class="whitespace-pre-wrap text-sm text-gray-700 leading-relaxed"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login/Register Modal -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-2 text-center text-blue-800">ç™»å½•æˆ–æ³¨å†Œ</h2>
            <p class="text-center text-sm text-gray-600 mb-6" id="auth-instructions">è¯·ä½¿ç”¨ä½ çš„é‚®ç®±æ³¨å†Œæˆ–ç™»å½•ã€‚æ–°ç”¨æˆ·æ— éœ€éªŒè¯å³å¯ä½¿ç”¨ã€‚</p>
            <div class="mb-4">
                <label class="block text-gray-700 font-semibold mb-2" for="email">é‚®ç®±</label>
                <input id="email" type="email" class="w-full p-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:border-blue-500" placeholder="your.email@example.com">
            </div>
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2" for="password">å¯†ç </label>
                <input id="password" type="password" class="w-full p-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:border-blue-500">
            </div>
            <div class="flex justify-between">
                <button id="login-button" class="px-6 py-3 bg-green-500 text-white rounded-full font-semibold hover:bg-green-600 transition-colors duration-300">ç™»å½•</button>
                <button id="signup-button" class="px-6 py-3 bg-blue-500 text-white rounded-full font-semibold hover:bg-blue-600 transition-colors duration-300">æ³¨å†Œ</button>
            </div>
            <p id="auth-message" class="mt-4 text-center text-red-500"></p>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loading-indicator" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded-lg">
            <div class="flex items-center gap-3">
                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
                <span class="text-gray-700">æ­£åœ¨åˆå§‹åŒ–...</span>
            </div>
        </div>
    </div>

    <script>
      // --- Supabase and API Configuration ---
      const SUPABASE_URL = 'https://nayzeswaeqlephcxbkih.supabase.co';
      const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5heXplc3dhZXFsZXBoY3hia2loIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2NTUwOTcsImV4cCI6MjA3MTIzMTA5N30.BgTn4B24Z9s1I9Dc1tNekN6UpmmaUoHyefghKaxSn4U';
      const GEMINI_API_KEY = 'AIzaSyATtpLyZOGJoU28v7GsO6JQ31DnFVTglsc'; // æ‚¨éœ€è¦å¡«å…¥æ‚¨çš„APIå¯†é’¥
      
      // --- Admin Whitelist ---
      const ADMIN_EMAILS = ['fshh.cn@gmail.com'];

      let supabase = null;
      let currentUser = null;
      let selectedEmployee = null;

      // åˆå§‹åŒ–åº”ç”¨
      async function initializeApp() {
          const loadingIndicator = document.getElementById('loading-indicator');
          const authModal = document.getElementById('auth-modal');
          
          try {
              loadingIndicator.classList.remove('hidden');
              
              // ç­‰å¾… Supabase åº“åŠ è½½
              await waitForSupabase();
              
              // åˆå§‹åŒ– Supabase å®¢æˆ·ç«¯
              supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
              
              // æ£€æŸ¥å½“å‰ç”¨æˆ·çŠ¶æ€
              const { data: { session } } = await supabase.auth.getSession();
              
              if (session && session.user) {
                  showApp(session.user);
              } else {
                  hideApp();
              }
              
              // è®¾ç½®è®¤è¯çŠ¶æ€ç›‘å¬å™¨
              supabase.auth.onAuthStateChange((event, session) => {
                  if (session && session.user) {
                      showApp(session.user);
                  } else {
                      hideApp();
                  }
              });
              
              setupEventListeners();
              
          } catch (error) {
              console.error('åˆå§‹åŒ–å¤±è´¥:', error);
              alert('åº”ç”¨åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚');
          } finally {
              loadingIndicator.classList.add('hidden');
          }
      }

      // ç­‰å¾… Supabase åº“åŠ è½½
      function waitForSupabase() {
          return new Promise((resolve, reject) => {
              let attempts = 0;
              const maxAttempts = 50;
              
              const check = () => {
                  if (window.supabase) {
                      resolve();
                  } else if (attempts < maxAttempts) {
                      attempts++;
                      setTimeout(check, 100);
                  } else {
                      reject(new Error('Supabase åº“åŠ è½½è¶…æ—¶'));
                  }
              };
              
              check();
          });
      }

      function showApp(user) {
          if (!ADMIN_EMAILS.includes(user.email)) {
              const authMessage = document.getElementById('auth-message');
              authMessage.textContent = 'æ‚¨çš„è´¦å·æœªè·æ‰¹å‡†ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ã€‚';
              return;
          }
          
          currentUser = user;
          document.getElementById('auth-modal').classList.add('hidden');
          document.getElementById('main-app').classList.remove('hidden');
          document.getElementById('user-info').textContent = `å½“å‰ç”¨æˆ·: ${user.email}`;
          fetchDocuments();
      }

      function hideApp() {
          currentUser = null;
          document.getElementById('auth-modal').classList.remove('hidden');
          document.getElementById('main-app').classList.add('hidden');
          document.getElementById('user-info').textContent = '';
          document.getElementById('doc-list').innerHTML = '';
      }

      function setupEventListeners() {
          // è®¤è¯ç›¸å…³äº‹ä»¶
          document.getElementById('login-button').addEventListener('click', handleLogin);
          document.getElementById('signup-button').addEventListener('click', handleSignup);
          document.getElementById('logout-button').addEventListener('click', handleLogout);
          
          // å‘˜å·¥é€‰æ‹©
          document.querySelectorAll('#employee-selection button').forEach(button => {
              button.addEventListener('click', () => selectEmployee(button));
          });
          
          // ä»»åŠ¡æäº¤
          document.getElementById('generate-button').addEventListener('click', handleTaskSubmission);
          
          // æ–‡ä»¶ä¸Šä¼ 
          document.getElementById('upload-button').addEventListener('click', handleFileUpload);
      }

      async function handleLogin() {
          const email = document.getElementById('email').value;
          const password = document.getElementById('password').value;
          const authMessage = document.getElementById('auth-message');
          
          authMessage.textContent = '';
          
          if (!email || !password) {
              authMessage.textContent = 'è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ';
              return;
          }
          
          try {
              const { error } = await supabase.auth.signInWithPassword({ email, password });
              if (error) throw error;
          } catch (error) {
              authMessage.textContent = 'ç™»å½•å¤±è´¥: ' + error.message;
          }
      }

      async function handleSignup() {
          const email = document.getElementById('email').value;
          const password = document.getElementById('password').value;
          const authMessage = document.getElementById('auth-message');
          
          authMessage.textContent = '';
          
          if (!email || !password) {
              authMessage.textContent = 'è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ';
              return;
          }
          
          if (password.length < 6) {
              authMessage.textContent = 'å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦';
              return;
          }
          
          try {
              const { error } = await supabase.auth.signUp({ email, password });
              if (error) throw error;
              authMessage.textContent = 'æ³¨å†ŒæˆåŠŸï¼å¦‚éœ€è¦é‚®ç®±éªŒè¯ï¼Œè¯·æ£€æŸ¥æ‚¨çš„é‚®ç®±ã€‚';
          } catch (error) {
              authMessage.textContent = 'æ³¨å†Œå¤±è´¥: ' + error.message;
          }
      }

      async function handleLogout() {
          try {
              await supabase.auth.signOut();
          } catch (error) {
              console.error('ç™»å‡ºå¤±è´¥:', error);
          }
      }

      function selectEmployee(button) {
          if (!currentUser) {
              alert('è¯·å…ˆç™»å½•ï¼');
              return;
          }
          
          // é‡ç½®æ‰€æœ‰æŒ‰é’®æ ·å¼
          document.querySelectorAll('#employee-selection button').forEach(btn => {
              btn.classList.remove('bg-blue-600', 'text-white', 'shadow-md', 'transform', 'scale-105');
              btn.classList.add('bg-gray-200', 'text-blue-800');
          });
          
          // æ¿€æ´»é€‰ä¸­çš„æŒ‰é’®
          button.classList.remove('bg-gray-200', 'text-blue-800');
          button.classList.add('bg-blue-600', 'text-white', 'shadow-md', 'transform', 'scale-105');
          
          selectedEmployee = button.dataset.employee;
          document.getElementById('prompt-label').textContent = `ä½ çš„æŒ‡ä»¤ (${selectedEmployee}):`;
          document.getElementById('generate-button').disabled = false;
      }

      async function handleTaskSubmission() {
          if (!currentUser) {
              alert('è¯·å…ˆç™»å½•ï¼');
              return;
          }
          
          const prompt = document.getElementById('prompt-input').value.trim();
          if (!prompt || !selectedEmployee) {
              document.getElementById('output-display').textContent = 'è¯·é€‰æ‹©ä¸€ä½AIå‘˜å·¥å¹¶è¾“å…¥æŒ‡ä»¤ã€‚';
              return;
          }
          
          const generateButton = document.getElementById('generate-button');
          const outputDisplay = document.getElementById('output-display');
          
          generateButton.disabled = true;
          generateButton.textContent = 'å·¥ä½œè¿›è¡Œä¸­...';
          outputDisplay.innerHTML = '<div class="flex justify-center items-center h-32"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div></div>';
          
          try {
              // è·å–ç°æœ‰æ–‡æ¡£ä½œä¸ºä¸Šä¸‹æ–‡
              const { data: existingDocs } = await supabase
                  .from('documents')
                  .select('*')
                  .eq('user_id', currentUser.id);
              
              const context = existingDocs 
                  ? existingDocs.map(doc => `[æ–‡æ¡£æ¥è‡ª${doc.employee}] ${doc.title}: ${doc.content}`).join('\n\n')
                  : '';
              
              // æ„å»ºå®Œæ•´çš„æç¤ºè¯
              const fullPrompt = buildFullPrompt(selectedEmployee, prompt, context);
              
              // è°ƒç”¨AI API
              const result = await callGeminiAPI(fullPrompt);
              
              // æ˜¾ç¤ºç»“æœ
              outputDisplay.innerHTML = `<pre class="whitespace-pre-wrap">${result}</pre>`;
              
              // ä¿å­˜æ–‡æ¡£
              await saveDocument(selectedEmployee, prompt, result);
              
          } catch (error) {
              console.error('ä»»åŠ¡å¤„ç†å¤±è´¥:', error);
              outputDisplay.textContent = 'ä»»åŠ¡å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚';
          } finally {
              generateButton.disabled = false;
              generateButton.textContent = 'æäº¤ä»»åŠ¡';
          }
      }

      async function handleFileUpload() {
          if (!currentUser) {
              alert('è¯·å…ˆç™»å½•ï¼');
              return;
          }
          
          const fileInput = document.getElementById('file-upload');
          const file = fileInput.files[0];
          
          if (!file) {
              alert('è¯·é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶ï¼');
              return;
          }
          
          const uploadButton = document.getElementById('upload-button');
          uploadButton.disabled = true;
          uploadButton.textContent = 'ä¸Šä¼ ä¸­...';
          
          try {
              await uploadFile(file);
              fileInput.value = '';
          } catch (error) {
              console.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥:', error);
              alert('æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼');
          } finally {
              uploadButton.disabled = false;
              uploadButton.textContent = 'ä¸Šä¼ ';
          }
      }

      // è·å–æ–‡æ¡£åˆ—è¡¨
      async function fetchDocuments() {
          if (!currentUser) return;
          
          try {
              const { data, error } = await supabase
                  .from('documents')
                  .select('*')
                  .eq('user_id', currentUser.id)
                  .order('created_at', { ascending: false });

              if (error) throw error;

              renderDocuments(data || []);
              
          } catch (error) {
              console.error('è·å–æ–‡æ¡£å¤±è´¥:', error);
          }
      }

      // æ¸²æŸ“æ–‡æ¡£åˆ—è¡¨
      function renderDocuments(documents) {
          const docList = document.getElementById('doc-list');
          docList.innerHTML = '';
          
          documents.forEach(doc => {
              const li = document.createElement('li');
              li.className = 'list-item cursor-pointer p-2 rounded-lg hover:bg-blue-200 transition-colors duration-200';
              
              const docTitle = document.createElement('span');
              docTitle.textContent = `${doc.employee}: ${doc.title}`;
              docTitle.className = 'flex-1 cursor-pointer';
              docTitle.onclick = () => {
                  document.getElementById('output-display').innerHTML = `<pre class="whitespace-pre-wrap">${doc.content}</pre>`;
                  document.querySelectorAll('#doc-list li').forEach(item => item.classList.remove('bg-blue-300'));
                  li.classList.add('bg-blue-300');
              };
              
              const actions = document.createElement('div');
              actions.className = 'flex gap-2';
              
              // ä¸‹è½½æŒ‰é’®
              const downloadBtn = document.createElement('button');
              downloadBtn.innerHTML = 'â†“';
              downloadBtn.className = 'text-blue-600 hover:text-blue-800 text-lg';
              downloadBtn.title = 'ä¸‹è½½';
              downloadBtn.onclick = () => downloadDocument(doc);
              
              // åˆ é™¤æŒ‰é’®
              const deleteBtn = document.createElement('button');
              deleteBtn.innerHTML = 'âœ•';
              deleteBtn.className = 'text-red-600 hover:text-red-800 text-lg';
              deleteBtn.title = 'åˆ é™¤';
              deleteBtn.onclick = () => deleteDocument(doc);
              
              actions.appendChild(downloadBtn);
              actions.appendChild(deleteBtn);
              
              li.appendChild(docTitle);
              li.appendChild(actions);
              docList.appendChild(li);
          });
      }

      // ä¿å­˜æ–‡æ¡£
      async function saveDocument(employee, prompt, content) {
          if (!currentUser) return;
          
          const title = prompt.length > 50 ? prompt.substring(0, 50) + '...' : prompt;
          
          try {
              const { error } = await supabase
                  .from('documents')
                  .insert([{ 
                      employee, 
                      title, 
                      content, 
                      user_id: currentUser.id 
                  }]);
                  
              if (error) throw error;
              
              await fetchDocuments();
              
          } catch (error) {
              console.error('ä¿å­˜æ–‡æ¡£å¤±è´¥:', error);
          }
      }

      // ä¸‹è½½æ–‡æ¡£
      function downloadDocument(doc) {
          const blob = new Blob([doc.content], { type: 'text/plain;charset=utf-8' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `${doc.title}.txt`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
      }

      // åˆ é™¤æ–‡æ¡£
      async function deleteDocument(doc) {
          if (!confirm(`ç¡®å®šè¦åˆ é™¤æ–‡æ¡£ "${doc.title}" å—ï¼Ÿ`)) return;
          
          try {
              const { error } = await supabase
                  .from('documents')
                  .delete()
                  .eq('id', doc.id);
                  
              if (error) throw error;
              
              await fetchDocuments();
              
          } catch (error) {
              console.error('åˆ é™¤æ–‡æ¡£å¤±è´¥:', error);
              alert('åˆ é™¤æ–‡æ¡£å¤±è´¥ï¼');
          }
      }

      // ä¸Šä¼ æ–‡ä»¶
      async function uploadFile(file) {
          const fileName = `${currentUser.id}/${Date.now()}_${file.name}`;
          
          try {
              const { data, error } = await supabase.storage
                  .from('documents')
                  .upload(fileName, file);

              if (error) throw error;

              await saveDocument('ç”¨æˆ·ä¸Šä¼ ', `å·²ä¸Šä¼ æ–‡ä»¶: ${file.name}`, `æ–‡ä»¶å·²æˆåŠŸä¸Šä¼ åˆ° Supabase Storageã€‚è·¯å¾„: ${data.path}`);
              
          } catch (error) {
              console.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥:', error);
              throw error;
          }
      }

      // æ„å»ºå®Œæ•´æç¤ºè¯
      function buildFullPrompt(employee, prompt, context) {
          const productDoc = `
ã€ŠAI Video Character Lab â€” äº§å“æ–‡æ¡£ v0.1ã€‹
1. äº§å“å®šä½
ä¸€å¥è¯æè¿°ï¼šä¸€ä¸ªå¸®åŠ©å†…å®¹åˆ›ä½œè€…"ä¸€ç«™å¼ç”ŸæˆAIè§†é¢‘ï¼Œå¹¶ä¿è¯è§’è‰²å½¢è±¡ä¸€è‡´æ€§"çš„åº”ç”¨ä¸å¹³å°ã€‚

ç›®æ ‡ç”¨æˆ·ï¼š
- çŸ­è§†é¢‘åšä¸»ï¼ˆæŠ–éŸ³ã€å¿«æ‰‹ã€å°çº¢ä¹¦ã€YouTube Shortsï¼‰
- å“ç‰Œå†…å®¹å›¢é˜Ÿï¼ˆæƒ³è¦ç»Ÿä¸€IPå½¢è±¡ï¼‰
- æ•™è‚² & åŸ¹è®­è§†é¢‘åˆ¶ä½œè€…ï¼ˆéœ€è¦é•¿æœŸä¿æŒè®²å¸ˆè§’è‰²ï¼‰

æ ¸å¿ƒç—›ç‚¹ï¼š
- ç”¨ AI ç”Ÿæˆè§†é¢‘æ—¶ï¼Œè§’è‰²å½¢è±¡å¸¸å¸¸"å˜è„¸"ï¼Œç¼ºä¹ä¸€è‡´æ€§ã€‚
- å†…å®¹åˆ›ä½œè€…ç¼ºä¹æŠ€æœ¯èƒŒæ™¯ï¼Œæ— æ³•ç»„è£…å¤æ‚çš„ AI å·¥å…·é“¾ã€‚
- ç°æœ‰å¹³å°ä»·æ ¼é«˜ã€æµç¨‹å¤æ‚ï¼Œä¸èƒ½ä¸€ç«™å¼è§£å†³é—®é¢˜ã€‚

äº§å“ä»·å€¼ä¸»å¼ ï¼š
- ä¸€ç«™å¼ï¼šä¸Šä¼ è§’è‰² â†’ è¾“å…¥è„šæœ¬ â†’ ä¸€é”®ç”Ÿæˆè§†é¢‘ã€‚
- è§’è‰²ä¸€è‡´æ€§ï¼šé€šè¿‡"è§’è‰² Embedding"æœºåˆ¶ä¿è¯è§’è‰²é•¿ç›¸ã€æœé¥°ã€é£æ ¼ç¨³å®šã€‚
- å¿«é€Ÿï¼š5 åˆ†é’Ÿå†…ç”Ÿæˆ Demo è§†é¢‘ã€‚

2. äº§å“åŠŸèƒ½
MVP å¿…é¡»åŠŸèƒ½ï¼ˆç¬¬1â€”2å‘¨ï¼‰ï¼š
- è§’è‰²ä¸Šä¼ ï¼šç”¨æˆ·ä¸Šä¼  3â€”5 å¼ åŒä¸€è§’è‰²å›¾ç‰‡ï¼Œç³»ç»Ÿç”Ÿæˆè§’è‰²å‘é‡ï¼ˆEmbeddingï¼‰ã€‚
- è„šæœ¬ç”Ÿæˆï¼šç”¨æˆ·è¾“å…¥æ–‡å­—ï¼ˆæˆ–ä¸Šä¼ æ–‡ç¨¿ï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆåˆ†é•œè„šæœ¬ã€‚
- è§†é¢‘ç”Ÿæˆï¼šé€šè¿‡è°ƒç”¨è§†é¢‘ç”Ÿæˆæ¨¡å‹ï¼Œä¿æŒè§’è‰²ä¸€è‡´ï¼Œç”Ÿæˆ 30 ç§’ä»¥å†…è§†é¢‘ã€‚
- è§†é¢‘ä¸‹è½½/åˆ†äº«ï¼šç”¨æˆ·å¯ç›´æ¥ä¸‹è½½è§†é¢‘æ–‡ä»¶ï¼Œæˆ–å¤åˆ¶åˆ†äº«é“¾æ¥ã€‚

æ‰©å±•åŠŸèƒ½ï¼ˆç¬¬3â€”6å‘¨ï¼‰ï¼š
- è§’è‰²åº“ï¼šä¿å­˜å¤šä¸ªè§’è‰²ï¼Œéšæ—¶è°ƒç”¨ã€‚
- é£æ ¼æ¨¡æ¿ï¼šæ—¥å¸¸ vlogã€å¤å¤ã€ç§‘æŠ€æ„Ÿã€å¡é€šç­‰ã€‚
- å¤šè¯­è¨€æ”¯æŒï¼šæ”¯æŒä¸­è‹±åŒè¯­è„šæœ¬ã€‚
- åä½œæ¨¡å¼ï¼šå›¢é˜Ÿå¤šäººå…±äº«è§’è‰²åº“ã€‚

3. æŠ€æœ¯é€‰å‹
å‰ç«¯ï¼šNext.js + Reactï¼Œæ‰˜ç®¡åœ¨ Vercel
åç«¯ï¼šFastAPI (Python) æˆ– Node.jsï¼Œæ•°æ®åº“ä½¿ç”¨ Supabase
æ¨¡å‹è°ƒç”¨ï¼šè§†é¢‘ç”Ÿæˆä½¿ç”¨ Runway Gen-3ã€Veo 3ã€Pika Labs ç­‰

4. å•†ä¸šæ¨¡å¼
- å…è´¹è¯•ç”¨ï¼š1 åˆ†é’Ÿè§†é¢‘
- æœˆè®¢é˜…ï¼šÂ¥99ï¼ˆ10 åˆ†é’Ÿ/æœˆï¼‰ / Â¥299ï¼ˆ50 åˆ†é’Ÿ/æœˆï¼‰
- ä¼ä¸šå®šåˆ¶ï¼šÂ¥2,999+/æœˆï¼ˆè§’è‰²åº“ + API æ¥å…¥ï¼‰
          `;

          return `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„${employee}ã€‚è¯·æ ¹æ®ä»¥ä¸‹ç”¨æˆ·æŒ‡ä»¤ã€é¡¹ç›®æ–‡æ¡£ä»¥åŠå…¶ä»–AIå‘˜å·¥çš„ç°æœ‰å·¥ä½œæ–‡æ¡£ï¼Œå®Œæˆä»»åŠ¡ã€‚

é¡¹ç›®æ–‡æ¡£ï¼š
${productDoc}

å…¶ä»–AIå‘˜å·¥çš„ç°æœ‰å·¥ä½œæ–‡æ¡£ï¼ˆä¾›ä½ å‚è€ƒï¼‰ï¼š
${context || 'æ— ç°æœ‰æ–‡æ¡£ã€‚'}

ç”¨æˆ·æŒ‡ä»¤ï¼š
${prompt}`;
      }

      // è°ƒç”¨ Gemini API
      async function callGeminiAPI(textPrompt) {
          if (!GEMINI_API_KEY) {
              return "é”™è¯¯ï¼šæœªè®¾ç½® Gemini API å¯†é’¥ã€‚è¯·åœ¨ä»£ç ä¸­å¡«å…¥æ‚¨çš„ API å¯†é’¥ã€‚";
          }
          
          try {
              const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({
                      contents: [{
                          parts: [{
                              text: textPrompt
                          }]
                      }]
                  })
              });

              if (!response.ok) {
                  throw new Error(`API è°ƒç”¨å¤±è´¥: ${response.status}`);
              }

              const result = await response.json();
              
              if (result.candidates && result.candidates.length > 0) {
                  return result.candidates[0].content.parts[0].text;
              } else {
                  return "ç”Ÿæˆå†…å®¹å¤±è´¥ï¼Œè¯·æ£€æŸ¥APIå“åº”ã€‚";
              }
              
          } catch (error) {
              console.error("Gemini API è°ƒç”¨å¤±è´¥:", error);
              return `ç”Ÿæˆå†…å®¹æ—¶å‘ç”Ÿé”™è¯¯: ${error.message}`;
          }
      }

      // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
      document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>