<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI å‘˜å·¥æŒ‡æŒ¥ä¸­å¿ƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* ç¡®ä¿é¡µé¢å…¨å±å±…ä¸­ */
      body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }
    </style>
</head>
<body>
    <div id="root" class="w-full"></div>

    <script>
        const { useState } = React;

        const App = () => {
          const [employee, setEmployee] = useState('');
          const [prompt, setPrompt] = useState('');
          const [output, setOutput] = useState('');
          const [loading, setLoading] = useState(false);

          const callGeminiAPI = async (textPrompt) => {
            try {
              const chatHistory = [];
              chatHistory.push({ role: "user", parts: [{ text: textPrompt }] });
              const payload = {
                  contents: chatHistory
              };
              
              const apiKey = "";
              const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
              
              const maxRetries = 5;
              let attempt = 0;
              let response;
              while (attempt < maxRetries) {
                try {
                  response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                  });
                  if (response.status !== 429) { 
                    break;
                  }
                  attempt++;
                  const delay = Math.pow(2, attempt) * 1000 + Math.random() * 1000;
                  console.log(`Rate limit exceeded, retrying in ${delay / 1000}s...`);
                  await new Promise(res => setTimeout(res, delay));
                } catch (error) {
                  attempt++;
                  const delay = Math.pow(2, attempt) * 1000 + Math.random() * 1000;
                  console.error(`Fetch attempt ${attempt} failed:`, error);
                  await new Promise(res => setTimeout(res, delay));
                }
              }

              if (!response || !response.ok) {
                throw new Error(`API call failed with status: ${response ? response.status : 'No response'}`);
              }

              const result = await response.json();
              if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                return result.candidates[0].content.parts[0].text;
              } else {
                throw new Error("Invalid response structure from API.");
              }

            } catch (e) {
              console.error("Error calling Gemini API:", e);
              return "ç”Ÿæˆå†…å®¹æ—¶å‘ç”Ÿé”™è¯¯ã€‚è¯·æ£€æŸ¥æ§åˆ¶å°äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚";
            }
          };

          const handleGenerate = async () => {
            if (!prompt.trim() || !employee) {
              setOutput('è¯·é€‰æ‹©ä¸€ä½AIå‘˜å·¥å¹¶è¾“å…¥æŒ‡ä»¤ã€‚');
              return;
            }
            
            setLoading(true);
            setOutput('æ­£åœ¨ä¸ºä½ ç”Ÿæˆå†…å®¹ï¼Œè¯·ç¨å€™...');

            let fullPrompt = '';
            const productDoc = `
            ã€ŠAI Video Character Lab â€“ äº§å“æ–‡æ¡£ v0.1ã€‹
            1. äº§å“å®šä½
            ä¸€å¥è¯æè¿°
            ä¸€ä¸ªå¸®åŠ©å†…å®¹åˆ›ä½œè€…â€œä¸€ç«™å¼ç”ŸæˆAIè§†é¢‘ï¼Œå¹¶ä¿è¯è§’è‰²å½¢è±¡ä¸€è‡´æ€§â€çš„åº”ç”¨ä¸å¹³å°ã€‚
            ... (rest of the document) ...
            AI å‘˜å·¥åˆ†å·¥ï¼ˆç¤ºä¾‹ï¼‰
            AI æ¶æ„å¸ˆï¼šChatGPTï¼ˆå†™æŠ€æœ¯æ–‡æ¡£ã€API è®¾è®¡ï¼‰
            AI ç¨‹åºå‘˜ï¼šCursor + Copilotï¼ˆå†™ä»£ç ï¼‰
            AI æµ‹è¯•å‘˜ï¼šClaudeï¼ˆç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ + å•å…ƒæµ‹è¯•ï¼‰
            AI æ–‡æ¡£å‘˜ï¼šNotion AIï¼ˆç”Ÿæˆç”¨æˆ·æ‰‹å†Œï¼‰
            AI å¸‚åœºä¸“å‘˜ï¼šChatGPTï¼ˆå†™è¥é”€æ–‡æ¡ˆã€æ¨å¹¿è®¡åˆ’ï¼‰
            `;

            switch (employee) {
              case 'AIæ¶æ„å¸ˆ':
                fullPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„AIæ¶æ„å¸ˆã€‚æ ¹æ®ä»¥ä¸‹ç”¨æˆ·æŒ‡ä»¤å’Œé¡¹ç›®æ–‡æ¡£ï¼Œè¯·ä¸ºã€ŠAI Video Character Labã€‹é¡¹ç›®è®¾è®¡ä¸€ä¸ªè¯¦ç»†çš„æŠ€æœ¯æ–¹æ¡ˆã€‚ä½ çš„å›ç­”åº”è¯¥ä¸“æ³¨äºAPIè®¾è®¡ã€æ•°æ®åº“ç»“æ„å’ŒæŠ€æœ¯æµç¨‹ã€‚

é¡¹ç›®æ–‡æ¡£ï¼š
${productDoc}

ç”¨æˆ·æŒ‡ä»¤ï¼š
${prompt}`;
                break;
              case 'AIç¨‹åºå‘˜':
                fullPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„AIç¨‹åºå‘˜ï¼Œæ“…é•¿ä½¿ç”¨Reactå’ŒPythonã€‚æ ¹æ®ä»¥ä¸‹ç”¨æˆ·æŒ‡ä»¤å’Œé¡¹ç›®æ–‡æ¡£ï¼Œè¯·ç¼–å†™å…·ä½“çš„ä»£ç ã€‚è¯·ç¡®ä¿ä»£ç æ˜¯å®Œæ•´çš„ã€å¯è¿è¡Œçš„ï¼Œå¹¶åŒ…å«è¯¦ç»†çš„æ³¨é‡Šã€‚ä½ çš„å›ç­”åº”è¯¥åªåŒ…å«ä»£ç ï¼Œä¸åŒ…å«ä»»ä½•è§£é‡Šæ€§æ–‡å­—ã€‚

é¡¹ç›®æ–‡æ¡£ï¼š
${productDoc}

ç”¨æˆ·æŒ‡ä»¤ï¼š
${prompt}`;
                break;
              case 'AIæ–‡æ¡£å‘˜':
                fullPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„AIæ–‡æ¡£å‘˜ã€‚æ ¹æ®ä»¥ä¸‹ç”¨æˆ·æŒ‡ä»¤å’Œé¡¹ç›®æ–‡æ¡£ï¼Œè¯·ä¸ºã€ŠAI Video Character Labã€‹é¡¹ç›®ç¼–å†™ä¸€ä»½ç”¨æˆ·æ‰‹å†Œæˆ–äº§å“æ–‡æ¡£ã€‚ä½ çš„å›ç­”åº”è¯¥ä»¥æ¸…æ™°ã€æ˜“æ‡‚çš„Markdownæ ¼å¼å‘ˆç°ã€‚

é¡¹ç›®æ–‡æ¡£ï¼š
${productDoc}

ç”¨æˆ·æŒ‡ä»¤ï¼š
${prompt}`;
                break;
              case 'AIæµ‹è¯•å‘˜':
                fullPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„AIæµ‹è¯•å‘˜ã€‚æ ¹æ®ä»¥ä¸‹ç”¨æˆ·æŒ‡ä»¤å’Œé¡¹ç›®æ–‡æ¡£ï¼Œè¯·ä¸ºã€ŠAI Video Character Labã€‹é¡¹ç›®ç¼–å†™ä¸€ä»½è¯¦ç»†çš„æµ‹è¯•ç”¨ä¾‹ã€‚æµ‹è¯•ç”¨ä¾‹åº”åŒ…å«æµ‹è¯•æ­¥éª¤ã€é¢„æœŸç»“æœå’Œæµ‹è¯•æ•°æ®ã€‚

é¡¹ç›®æ–‡æ¡£ï¼š
${productDoc}

ç”¨æˆ·æŒ‡ä»¤ï¼š
${prompt}`;
                break;
              case 'AIå¸‚åœºä¸“å‘˜':
                fullPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„AIå¸‚åœºä¸“å‘˜ã€‚æ ¹æ®ä»¥ä¸‹ç”¨æˆ·æŒ‡ä»¤å’Œé¡¹ç›®æ–‡æ¡£ï¼Œè¯·ä¸ºã€ŠAI Video Character Labã€‹é¡¹ç›®ç¼–å†™ä¸€ä»½è¥é”€æ–‡æ¡ˆæˆ–æ¨å¹¿è®¡åˆ’ã€‚

é¡¹ç›®æ–‡æ¡£ï¼š
${productDoc}

ç”¨æˆ·æŒ‡ä»¤ï¼š
${prompt}`;
                break;
              default:
                fullPrompt = 'è¯·é€‰æ‹©ä¸€ä½AIå‘˜å·¥ã€‚';
            }

            const result = await callGeminiAPI(fullPrompt);
            setOutput(result);
            setLoading(false);
          };

          return (
            <div className="p-6 bg-gray-100 min-h-screen font-sans antialiased text-gray-800">
              <div className="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8">
                {/* Header and Title */}
                <h1 className="text-3xl font-bold text-center text-blue-800 mb-4">AIæ•°å­—å…¬å¸æŒ‡æŒ¥ä¸­å¿ƒ</h1>
                <p className="text-center text-gray-600 mb-8">é€‰æ‹©ä½ çš„AIå‘˜å·¥ï¼Œå¹¶åˆ†é…ä»»åŠ¡ã€‚</p>

                {/* Employee Selection */}
                <div className="flex flex-wrap justify-center gap-4 mb-6">
                  <button
                    onClick={() => setEmployee('AIæ¶æ„å¸ˆ')}
                    className={`px-6 py-3 rounded-full font-semibold transition-all duration-300
                      ${employee === 'AIæ¶æ„å¸ˆ' ? 'bg-blue-600 text-white shadow-md transform scale-105' : 'bg-gray-200 text-blue-800 hover:bg-blue-100'}`}
                  >
                    AIæ¶æ„å¸ˆ ğŸ‘©â€ğŸ’»
                  </button>
                  <button
                    onClick={() => setEmployee('AIç¨‹åºå‘˜')}
                    className={`px-6 py-3 rounded-full font-semibold transition-all duration-300
                      ${employee === 'AIç¨‹åºå‘˜' ? 'bg-blue-600 text-white shadow-md transform scale-105' : 'bg-gray-200 text-blue-800 hover:bg-blue-100'}`}
                  >
                    AIç¨‹åºå‘˜ ğŸ‘¨â€ğŸ’»
                  </button>
                  <button
                    onClick={() => setEmployee('AIæ–‡æ¡£å‘˜')}
                    className={`px-6 py-3 rounded-full font-semibold transition-all duration-300
                      ${employee === 'AIæ–‡æ¡£å‘˜' ? 'bg-blue-600 text-white shadow-md transform scale-105' : 'bg-gray-200 text-blue-800 hover:bg-blue-100'}`}
                  >
                    AIæ–‡æ¡£å‘˜ âœï¸
                  </button>
                  <button
                    onClick={() => setEmployee('AIæµ‹è¯•å‘˜')}
                    className={`px-6 py-3 rounded-full font-semibold transition-all duration-300
                      ${employee === 'AIæµ‹è¯•å‘˜' ? 'bg-blue-600 text-white shadow-md transform scale-105' : 'bg-gray-200 text-blue-800 hover:bg-blue-100'}`}
                  >
                    AIæµ‹è¯•å‘˜ ğŸ§ª
                  </button>
                  <button
                    onClick={() => setEmployee('AIå¸‚åœºä¸“å‘˜')}
                    className={`px-6 py-3 rounded-full font-semibold transition-all duration-300
                      ${employee === 'AIå¸‚åœºä¸“å‘˜' ? 'bg-blue-600 text-white shadow-md transform scale-105' : 'bg-gray-200 text-blue-800 hover:bg-blue-100'}`}
                  >
                    AIå¸‚åœºä¸“å‘˜ ğŸ“ˆ
                  </button>
                </div>

                {/* Prompt Input */}
                <div className="mb-6">
                  <label className="block text-gray-700 font-semibold mb-2">ä½ çš„æŒ‡ä»¤ ({employee || 'è¯·å…ˆé€‰æ‹©å‘˜å·¥'}):</label>
                  <textarea
                    className="w-full h-32 px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:border-blue-500 transition-all duration-300 resize-none"
                    placeholder="ä¾‹å¦‚ï¼šè¯·ä¸ºMVPçš„ç™»å½•åŠŸèƒ½è®¾è®¡æ•°æ®åº“è¡¨ç»“æ„ã€‚"
                    value={prompt}
                    onChange={(e) => setPrompt(e.target.value)}
                  ></textarea>
                </div>
                
                {/* Action Button */}
                <div className="flex justify-center mb-8">
                  <button
                    onClick={handleGenerate}
                    disabled={!employee || !prompt.trim() || loading}
                    className="px-8 py-4 bg-green-500 text-white font-bold rounded-full shadow-md hover:bg-green-600 transition-all duration-300 transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed"
                  >
                    {loading ? 'å·¥ä½œè¿›è¡Œä¸­...' : 'æäº¤ä»»åŠ¡'}
                  </button>
                </div>

                {/* Output Display */}
                <div className="bg-gray-50 rounded-lg p-6 border border-gray-200 min-h-80">
                  <h2 className="text-xl font-bold text-gray-700 mb-4">AIå‘˜å·¥çš„è¾“å‡º:</h2>
                  {output && (
                    <div className="whitespace-pre-wrap text-sm text-gray-700 leading-relaxed">
                      {loading ? (
                        <div className="flex justify-center items-center h-full">
                          <div className="w-8 h-8 border-4 border-dashed rounded-full animate-spin border-blue-500"></div>
                        </div>
                      ) : (
                        output
                      )}
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
